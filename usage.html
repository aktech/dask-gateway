

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Usage &mdash; Dask Gateway 0.9.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/js/custom.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/style.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/explore.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/nbsphinx.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Configuration" href="configuration-user.html" />
    <link rel="prev" title="Installation" href="install-user.html" />
  <link rel="shortcut icon" href="_static/images/favicon.ico"/>
  
  <meta name="Description" content="Usage">
  <meta property="og:description" content="Usage">
  <meta name="twitter:description" content="Usage" />
  <meta property="og:title" content="Dask Gateway 0.9.0 documentation - Usage">
  <meta property="og:image" content="https://github.com/dask.png">
  <meta property="og:image:secure_url" content="https://github.com/dask.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="380" />
  <meta property="og:image:height" content="380" />
  <meta property="og:url" content="usage.html">
  <meta property="og:site_name" content="Dask Gateway 0.9.0 documentation">

  <meta name="twitter:site" content="https://dask.org" />
  <meta name="twitter:creator" content="@dask_dev" />
  <meta name="twitter:card" content="summary">
  <meta name="twitter:image" content="https://github.com/dask.png" />
  <meta name="twitter:image:alt" content="Dask Gateway 0.9.0 documentation">
  

</head>

<body class="wy-body-for-nav">

  
    <nav id="explore-links">
        <a href="https://docs.dask.org/">
        <img class="caption" src="_static/images/dask-horizontal-white.svg"/>
        </a>

        <ul>
        <li>
            <a>Get Started</a>
            <ul>
            <li><a href="https://docs.dask.org/en/latest/install.html"> Install </a></li>
            <li><a href="https://examples.dask.org"> Examples </a></li>
            <li><a href="https://github.com/dask/dask-tutorial"> Tutorial </a></li>
            <li><a href="https://docs.dask.org/en/latest/why.html"> Why Dask? </a></li>
            <li><a href="https://stories.dask.org/en/latest"> Use Cases </a></li>
            <li><a href="https://www.youtube.com/watch?v=RA_2qdipVng&list=PLRtz5iA93T4PQvWuoMnIyEIz1fXiJ5Pri"> Talks </a></li>
            <li><a href="https://mybinder.org/v2/gh/dask/dask-examples/master?urlpath=lab"> Try Online </a></li>
            <li><a href="https://dask.org/slides"> Slides </a></li>
            </ul>
        </li>

        <li>
            <a href="">Algorithms</a>
            <ul>
            <li><a href="https://docs.dask.org/en/latest/array.html">Arrays</a></li>
            <li><a href="https://docs.dask.org/en/latest/dataframe.html">Dataframes</a></li>
            <li><a href="https://docs.dask.org/en/latest/bag.html">Bags</a></li>
            <li><a href="https://docs.dask.org/en/latest/delayed.html">Delayed (custom)</a></li>
            <li><a href="https://docs.dask.org/en/latest/futures.html">Futures (real-time)</a></li>
            <li><a href="http://ml.dask.org">Machine Learning</a></li>
            <li><a href="https://xarray.pydata.org/en/latest/">XArray</a></li>
            </ul>
        </li>

        <li>
            <a href="https://docs.dask.org/en/latest/setup.html">Setup</a>
            <ul>
            <li><a href="https://docs.dask.org/en/latest/setup/single-machine.html"> Local </a></li>
            <li><a href="https://docs.dask.org/en/latest/setup/cloud.html"> Cloud </a></li>
            <li><a href="https://docs.dask.org/en/latest/setup/hpc.html"> HPC </a></li>
            <li><a href="https://kubernetes.dask.org/en/latest/"> Kubernetes </a></li>
            <li><a href="https://yarn.dask.org/en/latest/"> Hadoop / Yarn </a></li>
            </ul>
        </li>

        <li>
            <a>Community</a>
            <ul>
            <li><a href="http://docs.dask.org/en/latest/support.html">Ask for Help</a></li>
            <li><a href="https://github.com/dask">Github</a></li>
            <li><a href="https://stackoverflow.com/questions/tagged/dask">Stack Overflow</a></li>
            <li><a href="https://twitter.com/dask_dev">Twitter</a></li>
            <li><a href="https://blog.dask.org/"> Developer Blog </a></li>
            <li><a href="https://youtube.com/c/dask-dev"> YouTube Channel </a></li>
            </ul>
        </li>
        </ul>

    </nav>
  
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Dask Gateway
          

          
          </a>

          
            
            
              <div class="version">
                0.9.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p><span class="caption-text">For Users</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install-user.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#connect-to-a-dask-gateway-server">Connect to a dask-gateway server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-new-cluster">Create a new cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-a-cluster">Configure a cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scale-up-a-cluster">Scale up a cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enable-adaptive-scaling">Enable adaptive scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connect-to-the-cluster">Connect to the cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-computations-on-the-cluster">Run computations on the cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#shutdown-the-cluster">Shutdown the cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connect-to-an-existing-cluster">Connect to an existing cluster</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration-user.html">Configuration</a></li>
</ul>
<p><span class="caption-text">Admin - Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install-local.html">Install Locally (Quickstart)</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-hadoop.html">Install on a Hadoop Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-kube.html">Install on a Kubernetes Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-jobqueue.html">Install on an HPC Job Queue</a></li>
</ul>
<p><span class="caption-text">Admin - Customization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster-options.html">Exposing Cluster Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="resource-limits.html">Cluster Resource Limits</a></li>
</ul>
<p><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api-client.html">Client API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-server.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="develop.html">Development</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Dask Gateway</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<p>Here we walk through a typical user workflow. This assumes you’ve already
installed the <code class="docutils literal notranslate"><span class="pre">dask-gateway</span></code> client library (see <a class="reference internal" href="install-user.html"><span class="doc">Installation</span></a>) and
have a <code class="docutils literal notranslate"><span class="pre">dask-gateway-server</span></code> running somewhere. For a completely local setup
of both client and server (for demos, testing, etc…) see <a class="reference internal" href="install-local.html"><span class="doc">Install Locally (Quickstart)</span></a>
instead.</p>
<section id="connect-to-a-dask-gateway-server">
<h2>Connect to a dask-gateway server<a class="headerlink" href="#connect-to-a-dask-gateway-server" title="Permalink to this headline">¶</a></h2>
<p>Users interact with a <code class="docutils literal notranslate"><span class="pre">dask-gateway-server</span></code> via the <code class="docutils literal notranslate"><span class="pre">dask-gateway</span></code> client
library. Typically a session starts by creating a <a class="reference internal" href="api-client.html#dask_gateway.Gateway" title="dask_gateway.Gateway"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gateway</span></code></a> client. This
takes a few parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">address</span></code>: The full address of the dask-gateway server.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proxy_address</span></code>: The full address of the dask-gateway scheduler proxy. If
not provided, this defaults to <code class="docutils literal notranslate"><span class="pre">address</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">auth</span></code>: The authentication method to use</p></li>
</ul>
<p>The values for each of these are specific to your deployment - consult your
administrator for more information about your specific deployment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dask_gateway</span> <span class="kn">import</span> <span class="n">Gateway</span>

<span class="c1"># -- Here we provide a few examples of creating a `Gateway` object --</span>

<span class="c1"># Gateway server running at http://mygateway.com with kerberos authentication</span>
<span class="n">gateway</span> <span class="o">=</span> <span class="n">Gateway</span><span class="p">(</span>
    <span class="n">address</span><span class="o">=</span><span class="s2">&quot;http://mygateway.com&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="s2">&quot;kerberos&quot;</span>
<span class="p">)</span>

<span class="c1"># Gateway server at http://146.148.58.187, proxy at</span>
<span class="c1"># tls://35.202.68.87:8786, with JupyterHub authentication</span>
<span class="n">gateway</span> <span class="o">=</span> <span class="n">Gateway</span><span class="p">(</span>
     <span class="s2">&quot;http://146.148.58.187&quot;</span><span class="p">,</span>
     <span class="n">proxy_address</span><span class="o">=</span><span class="s2">&quot;tls://35.202.68.87:8786&quot;</span><span class="p">,</span>
     <span class="n">auth</span><span class="o">=</span><span class="s2">&quot;jupyterhub&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Typically these parameters are configured once in <a class="reference internal" href="configuration-user.html"><span class="doc">Configuration</span></a>, at
which point a <a class="reference internal" href="api-client.html#dask_gateway.Gateway" title="dask_gateway.Gateway"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gateway</span></code></a> object can be created with no parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dask_gateway</span> <span class="kn">import</span> <span class="n">Gateway</span>

<span class="c1"># Use values stored in your local configuration (recommended)</span>
<span class="n">gateway</span> <span class="o">=</span> <span class="n">Gateway</span><span class="p">()</span>
</pre></div>
</div>
<p>To check that everything is setup properly, query the gateway to see any
existing clusters. If this call completes, you should have a properly
configured gateway client.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gateway</span><span class="o">.</span><span class="n">list_clusters</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</section>
<section id="create-a-new-cluster">
<span id="usage-create-new-cluster"></span><h2>Create a new cluster<a class="headerlink" href="#create-a-new-cluster" title="Permalink to this headline">¶</a></h2>
<p>To create a new cluster, you can use the <a class="reference internal" href="api-client.html#dask_gateway.Gateway.new_cluster" title="dask_gateway.Gateway.new_cluster"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gateway.new_cluster()</span></code></a> method.
This will create a new cluster with no workers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cluster</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="n">new_cluster</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cluster</span>
<span class="go">GatewayCluster&lt;6c14f41343ea462599f126818a14ebd2&gt;</span>
</pre></div>
</div>
<p>Alternatively, you can skip creating a <a class="reference internal" href="api-client.html#dask_gateway.Gateway" title="dask_gateway.Gateway"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gateway</span></code></a> object, and use the
<a class="reference internal" href="api-client.html#dask_gateway.GatewayCluster" title="dask_gateway.GatewayCluster"><code class="xref py py-class docutils literal notranslate"><span class="pre">GatewayCluster</span></code></a> constructor directly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dask_gateway</span> <span class="kn">import</span> <span class="n">GatewayCluster</span>
<span class="go"># Create a new cluster using the GatewayCluster constructor directly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cluster</span> <span class="o">=</span> <span class="n">GatewayCluster</span><span class="p">()</span>
</pre></div>
</div>
<p>The choice between methods is largely preferential. If you need to interact
with the gateway server only to create a new cluster then using
<a class="reference internal" href="api-client.html#dask_gateway.GatewayCluster" title="dask_gateway.GatewayCluster"><code class="xref py py-class docutils literal notranslate"><span class="pre">GatewayCluster</span></code></a> may be simpler. If you need to perform other operations
(e.g. querying running clusters) then you may wish to use a <a class="reference internal" href="api-client.html#dask_gateway.Gateway" title="dask_gateway.Gateway"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gateway</span></code></a>
instead.</p>
</section>
<section id="configure-a-cluster">
<span id="user-cluster-options"></span><h2>Configure a cluster<a class="headerlink" href="#configure-a-cluster" title="Permalink to this headline">¶</a></h2>
<p>Some <code class="docutils literal notranslate"><span class="pre">dask-gateway-server</span></code> deployments allow users to configure their
clusters upon launching. Typical options may include specifying worker
memory/cores or which docker image to use. To see which options (if any) your
server supports you can use the <a class="reference internal" href="api-client.html#dask_gateway.Gateway.cluster_options" title="dask_gateway.Gateway.cluster_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gateway.cluster_options()</span></code></a> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">options</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="n">cluster_options</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">options</span>
<span class="go">Options&lt;worker_cores=1, worker_memory=1.0, environment=&#39;basic&#39;&gt;</span>
</pre></div>
</div>
<p>This returns a <code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code> object, which describes the options available.
The options object is a <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.MutableMapping">MutableMapping</a>, that also supports attribute access of
fields.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Both attribute and key access works</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">options</span><span class="o">.</span><span class="n">worker_cores</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;worker_cores&quot;</span><span class="p">]</span>
<span class="mi">1</span>

<span class="c1"># Can change values using attribute or key access</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">options</span><span class="o">.</span><span class="n">worker_cores</span> <span class="o">=</span> <span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">options</span><span class="o">.</span><span class="n">worker_cores</span>
<span class="mi">2</span>
</pre></div>
</div>
<p>Note that validation of the fields is done both client and server-side. For
example, if a limit has been set on a numeric field (e.g. max
<code class="docutils literal notranslate"><span class="pre">worker_cores</span></code>), then a nice error will be raised if that limit is exceeded.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">options</span><span class="o">.</span><span class="n">worker_cores</span> <span class="o">=</span> <span class="mi">10</span>
<span class="go">    Traceback (most recent call last):</span>
<span class="go">            ...</span>
<span class="go">    ValueError: worker_cores must be &lt;= 4, got 10</span>
</pre></div>
</div>
<p>If you’re working interactively in a <a class="reference external" href="https://jupyter-notebook.readthedocs.io/en/stable/">Jupyter Notebook</a> or <a class="reference external" href="https://jupyterlab.readthedocs.io/en/latest/">JupyterLab</a> and
have <a class="reference external" href="https://ipywidgets.readthedocs.io/en/latest/">ipywidgets</a> installed, you can also use the provided widget for
configuring your cluster.</p>
<img alt="Cluster options widget" src="_images/options-widget.png" />
<p>Once <code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code> object has the desired values set, you can pass this to
<a class="reference internal" href="api-client.html#dask_gateway.Gateway.new_cluster" title="dask_gateway.Gateway.new_cluster"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gateway.new_cluster()</span></code></a> or <a class="reference internal" href="api-client.html#dask_gateway.GatewayCluster" title="dask_gateway.GatewayCluster"><code class="xref py py-class docutils literal notranslate"><span class="pre">GatewayCluster</span></code></a> to use these values when
creating a new cluster.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using Gateway.new_cluster</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cluster</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="n">new_cluster</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

<span class="c1"># Or using the GatewayCluster constructor</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cluster</span> <span class="o">=</span> <span class="n">GatewayCluster</span><span class="p">(</span><span class="n">cluster_options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, if you know the configurable options available on your
<code class="docutils literal notranslate"><span class="pre">dask-gateway-server</span></code> deployment, you can pass in your values directly as
keyword arguments to either method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using Gateway.new_cluster</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cluster</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="n">new_cluster</span><span class="p">(</span><span class="n">worker_cores</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">environment</span><span class="o">=</span><span class="s2">&quot;tensorflow&quot;</span><span class="p">)</span>

<span class="c1"># Or using the GatewayCluster constructor</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cluster</span> <span class="o">=</span> <span class="n">GatewayCluster</span><span class="p">(</span><span class="n">worker_cores</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">environment</span><span class="o">=</span><span class="s2">&quot;tensorflow&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="scale-up-a-cluster">
<h2>Scale up a cluster<a class="headerlink" href="#scale-up-a-cluster" title="Permalink to this headline">¶</a></h2>
<p>To scale a cluster to one or more workers, you can use the
<a class="reference internal" href="api-client.html#dask_gateway.GatewayCluster.scale" title="dask_gateway.GatewayCluster.scale"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GatewayCluster.scale()</span></code></a> method. Here we scale our cluster up to two
workers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cluster</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>If you’re working interactively in a <a class="reference external" href="https://jupyter-notebook.readthedocs.io/en/stable/">Jupyter Notebook</a> or <a class="reference external" href="https://jupyterlab.readthedocs.io/en/latest/">JupyterLab</a> and
have <a class="reference external" href="https://ipywidgets.readthedocs.io/en/latest/">ipywidgets</a> installed, you can also use the provided widget to change the
cluster size, instead of calling <a class="reference internal" href="api-client.html#dask_gateway.GatewayCluster.scale" title="dask_gateway.GatewayCluster.scale"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GatewayCluster.scale()</span></code></a> programmatically.</p>
<img alt="Manual scaling widget" src="_images/scale-widget.png" />
</section>
<section id="enable-adaptive-scaling">
<h2>Enable adaptive scaling<a class="headerlink" href="#enable-adaptive-scaling" title="Permalink to this headline">¶</a></h2>
<p>Alternatively, you can use <a class="reference external" href="https://docs.dask.org/en/latest/setup/adaptive.html">adaptive scaling</a> to allow your cluster to scale
up/down based on load. This can be useful in reducing resource usage only to
what’s currently required for your workload. To enable adaptive scaling you can
use the <a class="reference internal" href="api-client.html#dask_gateway.GatewayCluster.adapt" title="dask_gateway.GatewayCluster.adapt"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GatewayCluster.adapt()</span></code></a> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adaptively scale between 2 and 10 workers</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cluster</span><span class="o">.</span><span class="n">adapt</span><span class="p">(</span><span class="n">minimum</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>As with manual scaling above, if you’re working in a notebook environment you
can also use the provided widget to enable adaptive scaling , instead of
calling <a class="reference internal" href="api-client.html#dask_gateway.GatewayCluster.adapt" title="dask_gateway.GatewayCluster.adapt"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GatewayCluster.adapt()</span></code></a> programmatically.</p>
<img alt="Manual scaling widget" src="_images/adapt-widget.png" />
<p>If you wish to disable adaptive scaling later you can pass in <code class="docutils literal notranslate"><span class="pre">active=False</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Disable adaptive scaling</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cluster</span><span class="o">.</span><span class="n">adapt</span><span class="p">(</span><span class="n">active</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="connect-to-the-cluster">
<h2>Connect to the cluster<a class="headerlink" href="#connect-to-the-cluster" title="Permalink to this headline">¶</a></h2>
<p>To connect to the cluster so you can start doing work, you can use the
<a class="reference internal" href="api-client.html#dask_gateway.GatewayCluster.get_client" title="dask_gateway.GatewayCluster.get_client"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GatewayCluster.get_client()</span></code></a> method. This returns a
<code class="docutils literal notranslate"><span class="pre">dask.distributed.Client</span></code> object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">get_client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span>
<span class="go">&lt;Client: scheduler=&#39;tls://198.51.100.1:65252&#39; processes=2 cores=2&gt;</span>
</pre></div>
</div>
</section>
<section id="run-computations-on-the-cluster">
<h2>Run computations on the cluster<a class="headerlink" href="#run-computations-on-the-cluster" title="Permalink to this headline">¶</a></h2>
<p>At this point you should be able to use normal <code class="docutils literal notranslate"><span class="pre">dask</span></code> methods to do work. For
example, here we take the mean of a random array.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dask.array</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">chunks</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="go">0.0022336223893512945</span>
</pre></div>
</div>
</section>
<section id="shutdown-the-cluster">
<h2>Shutdown the cluster<a class="headerlink" href="#shutdown-the-cluster" title="Permalink to this headline">¶</a></h2>
<p>When you’re done using it, you can shutdown the cluster using the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Cluster.shutdown()</span></code> method. This will cleanly close all dask workers, as
well as the scheduler.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cluster</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that when a <a class="reference internal" href="api-client.html#dask_gateway.GatewayCluster" title="dask_gateway.GatewayCluster"><code class="xref py py-class docutils literal notranslate"><span class="pre">GatewayCluster</span></code></a> object is used as a context manager,
<code class="docutils literal notranslate"><span class="pre">shutdown</span></code> will be called automatically on context exit:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">gateway</span><span class="o">.</span><span class="n">new_cluster</span><span class="p">()</span> <span class="k">as</span> <span class="n">cluster</span><span class="p">:</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">get_client</span><span class="p">()</span>
    <span class="c1"># ...</span>
</pre></div>
</div>
<p>Alternatively, lingering cluster objects will be automatically shutdown when
your client process closes. It’s good practice to explicitly clean things up,
but it’s not strictly necessary. If you want clusters to persist longer than
the lifetime of your client process, set <code class="docutils literal notranslate"><span class="pre">shutdown_on_close=False</span></code> when
calling <a class="reference internal" href="api-client.html#dask_gateway.Gateway.new_cluster" title="dask_gateway.Gateway.new_cluster"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gateway.new_cluster()</span></code></a>.</p>
</section>
<section id="connect-to-an-existing-cluster">
<h2>Connect to an existing cluster<a class="headerlink" href="#connect-to-an-existing-cluster" title="Permalink to this headline">¶</a></h2>
<p>Alternatively, you can leave a cluster running and reconnect to it later.  To
do this, set <code class="docutils literal notranslate"><span class="pre">shutdown_on_close=False</span></code> when calling
<a class="reference internal" href="api-client.html#dask_gateway.Gateway.new_cluster" title="dask_gateway.Gateway.new_cluster"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gateway.new_cluster()</span></code></a> - this allows Dask clusters to persist longer than
the lifetime of your client process.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new cluster which will persist longer than the lifetime of the</span>
<span class="c1"># client process</span>
<span class="n">cluster</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="n">new_cluster</span><span class="p">(</span><span class="n">shutdown_on_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>To connect to a running cluster, you need the cluster’s name (a unique
identifier). If you don’t already know it, you can see all running clusters
using the <a class="reference internal" href="api-client.html#dask_gateway.Gateway.list_clusters" title="dask_gateway.Gateway.list_clusters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gateway.list_clusters()</span></code></a> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clusters</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="n">list_clusters</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clusters</span>
<span class="go">[ClusterReport&lt;name=ce498e95403741118a8f418ee242e646, status=RUNNING&gt;]</span>
</pre></div>
</div>
<p>You can then connect to an existing cluster using the <a class="reference internal" href="api-client.html#dask_gateway.Gateway.connect" title="dask_gateway.Gateway.connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gateway.connect()</span></code></a>
method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cluster</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">clusters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cluster</span>
<span class="go">GatewayCluster&lt;ce498e95403741118a8f418ee242e646&gt;</span>
</pre></div>
</div>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="configuration-user.html" class="btn btn-neutral float-right" title="Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install-user.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jim Crist-Harif

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>